#!/usr/bin/env zsh
source ${0:A:h}/../../deploy

# only for macOS
[[ $(_os) != macos ]] && exit

brew_deps=(
  node
  karabiner-elements
)

# link() {}

install() {
  brew install ${brew_deps[@]}

  if _is_callable nodenv; then
    echo "Installing required node version"
    nodenv install < .node-version
  else
    echo "Make sure to install the required node version"
  fi

  npm install
}

update() {
  npm run export "$KARABINER_CONFIG_DIR"
}

clean() {
  rm -rfv "$KARABINER_CONFIG_DIR/{karabiner.json,assets}"
}

init "$@"
